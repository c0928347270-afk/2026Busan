<2026 ÈüìÂúãÈáúÂ±±5Êó•ÈÅä>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Busan Trip 2026 üíñ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@300;500&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        macaron: {
                            pink: '#FFC8DD',
                            blue: '#A2D2FF',
                            yellow: '#FDFD96',
                            green: '#BDE0FE',
                            mint: '#C1E1C1',
                            purple: '#CDB4DB',
                            dark: '#555555'
                        }
                    },
                    fontFamily: {
                        cute: ['"Kiwi Maru"', '"Nunito"', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Kiwi Maru', 'Nunito', sans-serif;
            background-color: #FFF9FA;
            color: #555;
            -webkit-tap-highlight-color: transparent;
        }
        
        .cute-card {
            background: #FFFFFF;
            border-radius: 20px;
            box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.05);
            border: 2px solid #FFF0F5;
        }

        .btn-press {
            transition: all 0.1s;
        }
        .btn-press:active {
            transform: scale(0.95);
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .tab-active {
            color: #FF6B6B;
            transform: scale(1.1);
        }
        
        .flight-gradient {
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
            border-color: #bae6fd;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-gray-700">

<div id="app" class="flex flex-col h-full">

    <header class="pt-10 pb-4 px-6 bg-macaron-pink rounded-b-[30px] shadow-sm z-10 relative overflow-hidden flex flex-col gap-2">
        <div class="flex justify-between items-center z-10">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 tracking-wide">
                    ÈáúÂ±±Ë°å 2026 üá∞üá∑
                </h1>
                <p class="text-xs text-gray-700 font-bold mt-1 opacity-70">Jan 21 - Jan 25</p>
            </div>
            <button @click="resetData" class="text-[10px] bg-white/60 px-3 py-1 rounded-full text-red-500 font-bold hover:bg-white transition">ÈáçÁΩÆË≥áÊñô</button>
        </div>
        
        <div class="bg-white/90 backdrop-blur-sm p-3 rounded-xl mt-2 flex items-start gap-3 shadow-sm border border-white/50">
            <div class="bg-macaron-purple text-white p-2 rounded-lg">
                <i class="ph ph-bed text-xl"></i>
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-xs font-bold text-gray-500 uppercase">‰ΩèÂÆøË≥áË®ä</p>
                <p class="text-sm font-bold text-gray-800 truncate">Aventree Hotel Busan</p>
                <p class="text-[10px] text-gray-500 truncate select-all">6 Gwangbok-ro 39beon-gil</p>
            </div>
            <a href="https://map.naver.com/p/search/Aventree%20Hotel%20Busan" target="_blank" class="bg-macaron-blue text-white p-2 rounded-lg text-xs font-bold whitespace-nowrap">
                Â∞éËà™
            </a>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto p-5 pb-28 space-y-5">
        
        <div v-if="currentTab === 'itinerary'" class="space-y-4">
            <div class="flex space-x-3 overflow-x-auto pb-2 no-scrollbar px-1">
                <button v-for="i in 5" :key="i" 
                    @click="activeDay = i"
                    :class="activeDay === i ? 'bg-macaron-blue text-white ring-2 ring-macaron-blue ring-offset-2' : 'bg-white text-gray-400 border border-gray-100'"
                    class="flex-shrink-0 w-14 h-14 rounded-2xl flex flex-col items-center justify-center shadow-sm transition-all duration-300">
                    <span class="text-[10px] uppercase font-bold">Day</span>
                    <span class="text-lg font-black leading-none">{{ i }}</span>
                </button>
            </div>

            <div class="space-y-4">
                <div v-if="filteredItinerary.length === 0" class="text-center py-10 text-gray-400">
                    <p>ÈªûÊìäÂè≥‰∏ãËßíÊåâÈàïÊñ∞Â¢ûË°åÁ®ã ‚ú®</p>
                </div>

                <div v-for="item in filteredItinerary" :key="item.id" 
                    class="cute-card p-4 flex gap-3 relative group"
                    :class="{'flight-gradient': item.isFlight}">
                    
                    <div class="flex flex-col items-center min-w-[60px]">
                        <span class="bg-macaron-yellow px-2 py-1 rounded-lg text-xs font-bold text-gray-700 shadow-sm border border-yellow-100 font-mono">
                            {{ item.time }}
                        </span>
                        <div class="h-full w-0.5 bg-gray-200 my-2 border-l-2 border-dotted"></div>
                    </div>

                    <div class="flex-1 pb-1 min-w-0">
                        <div class="flex justify-between items-start">
                            <h3 class="font-bold text-[16px] text-gray-800 leading-tight pr-6">{{ item.title }}</h3>
                            <div class="flex gap-2">
                                <button @click="openModal(item)" class="text-gray-400 hover:text-blue-500 btn-press">
                                    <i class="ph ph-pencil-simple text-lg"></i>
                                </button>
                                <button v-if="!item.isFlight" @click="deleteItem(item.id)" class="text-gray-400 hover:text-red-400 btn-press">
                                    <i class="ph ph-trash text-lg"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="mt-1 flex items-center text-xs text-gray-500 font-medium">
                            <i v-if="item.isFlight" class="ph ph-airplane-tilt mr-1 text-blue-400"></i>
                            <i v-else class="ph ph-map-pin mr-1 text-gray-400"></i>
                            <span class="truncate">{{ item.location }}</span>
                        </div>

                        <p v-if="item.desc" class="text-xs text-gray-600 mt-2 bg-white/60 p-2 rounded-lg inline-block border border-gray-100 w-full whitespace-pre-wrap">
                           {{ item.desc }}
                        </p>

                        <a v-if="!item.isFlight" :href="getNaverMapLink(item.location)" target="_blank" 
                           class="mt-3 inline-flex items-center text-[10px] font-bold text-gray-700 bg-macaron-mint px-3 py-1.5 rounded-xl shadow-sm hover:bg-green-300 transition-colors">
                            <i class="ph ph-navigation-arrow mr-1"></i> Naver Map
                        </a>
                    </div>
                </div>
            </div>
            
            <button @click="openModal(null)" class="fixed bottom-24 right-5 bg-gray-800 text-white w-14 h-14 rounded-2xl shadow-xl flex items-center justify-center text-2xl z-20 hover:scale-105 transition-transform btn-press border-2 border-white">
                <i class="ph ph-plus"></i>
            </button>
        </div>

        <div v-if="currentTab === 'expense'" class="space-y-5">
            
            <div class="cute-card p-5 bg-gradient-to-br from-macaron-blue to-blue-200 border-none text-white relative overflow-hidden">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-xs font-medium opacity-80">Êú¨Ë∂üÊóÖÁ®ãÁ∏ΩËä±Ë≤ª</p>
                        <h2 class="text-3xl font-black mt-1">‚Ç© {{ formatNumber(totalExpenseKRW) }}</h2>
                        <p class="text-sm font-bold mt-1 text-blue-50">‚âà NT$ {{ formatNumber(totalExpenseTWD) }}</p>
                    </div>
                    <div class="text-right">
                        <label class="text-[10px] block opacity-70 mb-1">ÂåØÁéá (1 TWD = ? KRW)</label>
                        <input v-model.number="exchangeRate" type="number" class="w-16 bg-white/20 text-white text-center font-bold rounded p-1 outline-none text-sm border border-white/30">
                    </div>
                </div>
            </div>

            <div class="cute-card p-4 space-y-3">
                <h3 class="font-bold text-gray-700 text-sm flex items-center gap-2">
                    <i class="ph ph-note-pencil text-macaron-purple text-lg"></i> Êñ∞Â¢ûÊîØÂá∫
                </h3>
                
                <div class="grid grid-cols-3 gap-2">
                    <input type="date" v-model="newExpense.date" class="col-span-1 bg-gray-50 px-2 py-3 rounded-xl text-xs outline-none border focus:border-macaron-purple text-center">
                    <input v-model="newExpense.item" placeholder="È†ÖÁõÆ (Â¶Ç: ÊôöÈ§ê)" class="col-span-2 bg-gray-50 px-4 py-3 rounded-xl text-sm outline-none border focus:border-macaron-purple">
                </div>

                <div class="flex gap-2 items-center">
                    <div class="relative flex-1">
                        <input v-model.number="newExpense.amount" type="number" placeholder="ÈüìÂπ£ÈáëÈ°ç" class="w-full bg-gray-50 px-4 py-3 pl-8 rounded-xl text-sm outline-none border focus:border-macaron-purple">
                        <span class="absolute left-3 top-3.5 text-gray-400 text-xs">‚Ç©</span>
                    </div>
                    <div class="text-xs font-bold text-gray-400 whitespace-nowrap min-w-[80px] text-right">
                        = NT$ {{ formatNumber(Math.round((newExpense.amount || 0) / exchangeRate)) }}
                    </div>
                </div>
                
                <button @click="addExpense" class="w-full bg-macaron-purple text-white py-3 rounded-xl font-bold text-sm shadow-md btn-press">
                    Ë®òÂ∏≥
                </button>
            </div>

            <div class="space-y-3 pb-8">
                <div v-for="(exp, index) in expenses" :key="index" class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center">
                    <div>
                        <div class="flex items-center gap-2">
                            <span class="text-[10px] bg-gray-100 px-1.5 py-0.5 rounded text-gray-500">{{ exp.date.slice(5) }}</span>
                            <p class="font-bold text-gray-800 text-sm">{{ exp.item }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="text-right">
                            <p class="font-bold text-gray-700 text-sm">‚Ç©{{ formatNumber(exp.amount) }}</p>
                            <p class="text-[10px] text-macaron-purple font-medium">NT$ {{ formatNumber(Math.round(exp.amount / exchangeRate)) }}</p>
                        </div>
                        <button @click="removeExpense(index)" class="text-gray-300 hover:text-red-400 p-1"><i class="ph ph-x-circle text-lg"></i></button>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'weather'" class="space-y-4">
             <div class="cute-card p-6 text-center bg-gradient-to-b from-sky-50 to-white">
                <h2 class="text-lg font-bold text-gray-600 uppercase tracking-widest mb-2">Busan</h2>
                <div v-if="weatherLoading" class="py-8 text-gray-400 text-sm">ËºâÂÖ•‰∏≠...</div>
                <div v-else>
                    <div class="text-6xl my-2">{{ getWeatherIcon(currentWeather.code) }}</div>
                    <p class="text-5xl font-black text-gray-800">{{ currentWeather.temp }}¬∞</p>
                    <div class="mt-4 flex justify-center gap-4 text-xs font-bold text-gray-500">
                        <span>ÈôçÈõ® {{ currentWeather.rain }}%</span>
                        <span>{{ currentWeather.desc }}</span>
                    </div>
                </div>
            </div>
            <a href="https://www.google.com/search?q=ÈáúÂ±±Â§©Ê∞£" target="_blank" class="block text-center text-xs text-blue-400 font-bold bg-white p-3 rounded-xl shadow-sm">
                ÂâçÂæÄ Google Êü•ÁúãË©≥Á¥∞Â§©Ê∞£
            </a>
        </div>

        <div v-if="currentTab === 'map'" class="h-full flex flex-col">
            <div class="bg-white p-3 rounded-2xl shadow-sm mb-4 border border-green-50">
                <div class="flex gap-2">
                    <input v-model="mapQuery" @keyup.enter="searchNaver" type="text" placeholder="Ëº∏ÂÖ•Âú∞Èªû (ÈüìÊñá/Ëã±Êñá)" class="flex-1 bg-gray-50 px-4 py-2.5 rounded-xl text-sm outline-none">
                    <button @click="searchNaver" class="bg-[#03C75A] text-white px-4 py-2 rounded-xl text-sm font-bold shadow-md btn-press">
                        Naver Map
                    </button>
                </div>
            </div>
            <div class="flex-1 rounded-3xl overflow-hidden shadow-sm border-4 border-white relative bg-gray-100">
                <iframe width="100%" height="100%" style="border:0" loading="lazy" src="http://googleusercontent.com/maps.google.com/7"></iframe>
            </div>
        </div>

    </main>

    <nav class="fixed bottom-0 w-full pb-safe pt-2 px-6 flex justify-between items-center bg-white/95 backdrop-blur-md rounded-t-[30px] shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-30 border-t border-gray-100">
        <button @click="currentTab = 'itinerary'" :class="currentTab === 'itinerary' ? 'text-macaron-pink tab-active' : 'text-gray-300'" class="flex flex-col items-center p-3 w-16 transition-all duration-300">
            <i class="ph ph-notebook text-2xl" :weight="currentTab === 'itinerary' ? 'fill' : 'regular'"></i>
            <span class="text-[10px] font-bold mt-1">Ë°åÁ®ã</span>
        </button>
        <button @click="currentTab = 'map'" :class="currentTab === 'map' ? 'text-macaron-mint tab-active' : 'text-gray-300'" class="flex flex-col items-center p-3 w-16 transition-all duration-300">
            <i class="ph ph-map-trifold text-2xl" :weight="currentTab === 'map' ? 'fill' : 'regular'"></i>
            <span class="text-[10px] font-bold mt-1">Âú∞Âúñ</span>
        </button>
        <button @click="currentTab = 'expense'" :class="currentTab === 'expense' ? 'text-macaron-blue tab-active' : 'text-gray-300'" class="flex flex-col items-center p-3 w-16 transition-all duration-300">
            <i class="ph ph-wallet text-2xl" :weight="currentTab === 'expense' ? 'fill' : 'regular'"></i>
            <span class="text-[10px] font-bold mt-1">Ë®òÂ∏≥</span>
        </button>
        <button @click="currentTab = 'weather'" :class="currentTab === 'weather' ? 'text-macaron-yellow text-yellow-400 tab-active' : 'text-gray-300'" class="flex flex-col items-center p-3 w-16 transition-all duration-300">
            <i class="ph ph-sun-horizon text-2xl" :weight="currentTab === 'weather' ? 'fill' : 'regular'"></i>
            <span class="text-[10px] font-bold mt-1">Â§©Ê∞£</span>
        </button>
    </nav>

    <div v-if="showModal" class="fixed inset-0 bg-gray-900/40 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl scale-100 transition-transform">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-bold text-gray-700">
                    {{ isEditMode ? 'Á∑®ËºØË°åÁ®ã ‚úèÔ∏è' : 'Êñ∞Â¢ûË°åÁ®ã ‚ú®' }}
                </h3>
                <button @click="showModal = false" class="bg-gray-100 w-8 h-8 rounded-full text-gray-500 hover:bg-gray-200"><i class="ph ph-x"></i></button>
            </div>
            <div class="space-y-3">
                <div>
                    <label class="text-xs text-macaron-purple font-bold ml-1">ÊôÇÈñì</label>
                    <input v-model="modalForm.time" type="time" class="w-full bg-gray-50 p-3 rounded-xl mt-1 outline-none border focus:border-macaron-purple">
                </div>
                <div>
                    <label class="text-xs text-macaron-purple font-bold ml-1">Ê®ôÈ°å</label>
                    <input v-model="modalForm.title" type="text" placeholder="Ë°åÁ®ãÂêçÁ®±" class="w-full bg-gray-50 p-3 rounded-xl mt-1 outline-none border focus:border-macaron-purple">
                </div>
                <div>
                    <label class="text-xs text-macaron-purple font-bold ml-1">Âú∞Èªû (Âú∞ÂúñÊêúÂ∞ãÁî®)</label>
                    <input v-model="modalForm.location" type="text" placeholder="Ëº∏ÂÖ•ÈóúÈçµÂ≠ó" class="w-full bg-gray-50 p-3 rounded-xl mt-1 outline-none border focus:border-macaron-purple">
                </div>
                <div>
                    <label class="text-xs text-macaron-purple font-bold ml-1">ÂÇôË®ª (ÁáüÊ•≠ÊôÇÈñì/Ë≥áË®ä)</label>
                    <textarea v-model="modalForm.desc" rows="3" placeholder="‰æãÂ¶ÇÔºöÁáüÊ•≠ÊôÇÈñì 10:00-22:00" class="w-full bg-gray-50 p-3 rounded-xl mt-1 outline-none border focus:border-macaron-purple resize-none"></textarea>
                </div>
            </div>
            <button @click="saveItem" class="w-full mt-6 py-3.5 bg-gray-800 text-white font-bold rounded-xl shadow-lg btn-press">
                ÂÑ≤Â≠ò
            </button>
        </div>
    </div>

</div>

<script>
    const { createApp, ref, computed, onMounted, watch } = Vue;

    createApp({
        setup() {
            // State
            const currentTab = ref('itinerary');
            const activeDay = ref(1);
            const showModal = ref(false);
            const isEditMode = ref(false);
            const mapQuery = ref('');
            
            // Expense State
            const exchangeRate = ref(41.5); // 1 TWD = 41.5 KRW
            const expenses = ref([]);
            const newExpense = ref({ date: '', item: '', amount: '' });

            // Modal Form Data
            const modalForm = ref({ id: null, time: '', title: '', location: '', desc: '' });

            // Default Data (With 2026 Flights & Aventree Hotel)
            const defaultItinerary = [
                // Day 1
                { id: 101, day: 1, time: '14:25', title: 'ÂéªÁ®ã: Èï∑Ê¶ÆËà™Á©∫ BR164', location: 'Taoyuan Intl Airport T2', desc: 'Á∂ìÊøüËâô V | 17:40 ÊäµÈÅîÈáúÂ±±', isFlight: true },
                { id: 102, day: 1, time: '19:00', title: 'È£ØÂ∫ó Check-in', location: 'Aventree Hotel Busan', desc: 'Âú∞ÂùÄÔºö6 Gwangbok-ro 39beon-gil' },
                { id: 103, day: 1, time: '20:00', title: 'ÊâéÂòéÂÖ∂Â∏ÇÂ†¥ / BIFFÂª£Â†¥', location: 'Jagalchi Market', desc: 'ÊôöÈ§ê„ÄÅÈÄõÂ§úÂ∏Ç' },

                // Day 2
                { id: 201, day: 2, time: '09:00', title: 'Êµ∑Èõ≤Âè∞ÂÇ≥Áµ±Â∏ÇÂ†¥', location: 'Haeundae Traditional Market', desc: 'Êó©È§êÔºöÂàÄÂâäÈ∫µ„ÄÅÈ£ØÊç≤' },
                { id: 202, day: 2, time: '10:20', title: 'Êµ∑Êù±ÈæçÂÆÆÂØ∫', location: 'Haedong Yonggungsa', desc: 'Êµ∑ÈÇäÂØ∫Âªü' },
                { id: 203, day: 2, time: '11:40', title: 'Ê®ÇÂ§© Outlet', location: 'Lotte Premium Outlets Dongbusan', desc: 'ÂçàÈ§ê + Ë≥ºÁâ©' },
                { id: 204, day: 2, time: '15:00', title: 'SPA LAND Ê±óËí∏Âπï', location: 'Spa Land Centum City', desc: 'Êñ∞‰∏ñÁïåÁôæË≤® B1' },

                // Day 3
                { id: 301, day: 3, time: '09:00', title: 'KKday‰∏ÄÊó•ÈÅäÈõÜÂêà', location: 'Busan Station', desc: 'ÂâçÂæÄÊÖ∂Â∑û' },
                { id: 302, day: 3, time: '10:30', title: 'Â§©Á©∫ËÜ†ÂõäÂàóËªä', location: 'Haeundae Blueline Park', desc: 'ËóçÁ∑öÂÖ¨Âúí' },
                { id: 303, day: 3, time: '15:00', title: '‰ΩõÂúãÂØ∫', location: 'Bulguksa', desc: 'ÊÖ∂Â∑û‰∏ñÁïåÈÅ∫Áî¢' },
                { id: 304, day: 3, time: '19:00', title: 'Êù±ÂÆÆËàáÊúàÊ±†', location: 'Donggung Palace and Wolji Pond', desc: 'Â§úÊôØ' },

                // Day 4
                { id: 401, day: 4, time: '09:30', title: 'ÊùæÂ≥∂Â§©Á©∫Ê≠•ÈÅì', location: 'Songdo Cloud Trails', desc: 'Êµ∑‰∏äÊ≠•ÈÅì' },
                { id: 402, day: 4, time: '10:20', title: 'ÊùæÂ≥∂Êµ∑‰∏äÁ∫úËªä', location: 'Songdo Marine Cable Car', desc: 'Ê∞¥Êô∂ËªäÂªÇ' },
                { id: 403, day: 4, time: '14:00', title: 'ÂΩ±Â≥∂Â§ßÊ©ãÈñãÊ©ã', location: 'Yeongdo Bridge', desc: 'Ê®ÇÂ§©ÁôæË≤®È†ÇÊ®ìËßÄÁúã' },
                { id: 404, day: 4, time: '15:00', title: 'ÁôΩÊ∑∫ÁÅòÊñáÂåñÊùë', location: 'Huinnyeoul Culture Village', desc: 'Êµ∑ÊôØÂíñÂï°Âª≥' },

                // Day 5
                { id: 501, day: 5, time: '09:00', title: 'ÁîòÂ∑ùÊ¥ûÊñáÂåñÊùë', location: 'Gamcheon Culture Village', desc: 'Â∞èÁéãÂ≠êÊãçÁÖß' },
                { id: 502, day: 5, time: '11:30', title: 'ËøîÂõûÂçóÊµ¶Ê¥û', location: 'Nampo Station', desc: 'ÊúÄÂæåÊé°Ë≤∑„ÄÅÊãøË°åÊùé' },
                { id: 503, day: 5, time: '15:30', title: 'ÂâçÂæÄÈáëÊµ∑Ê©üÂ†¥', location: 'Gimhae International Airport', desc: 'Ëæ¶ÁêÜÈÄÄÁ®Ö„ÄÅÁôªÊ©ü' },
                { id: 504, day: 5, time: '18:55', title: 'ÂõûÁ®ã: Èï∑Ê¶ÆËà™Á©∫ BR163', location: 'Gimhae International Airport', desc: 'Á∂ìÊøüËâô V | 20:25 ÊäµÈÅîÊ°ÉÂúí', isFlight: true },
            ];

            const itinerary = ref([]);
            const weatherLoading = ref(true);
            const currentWeather = ref({ temp: '--', desc: '--', rain: 0, code: 0 });

            // Initialize
            onMounted(() => {
                // Set default expense date to today
                const today = new Date().toISOString().split('T')[0];
                newExpense.value.date = today;

                // Load Data
                const savedItinerary = localStorage.getItem('busan_2026_itinerary');
                const savedExpenses = localStorage.getItem('busan_2026_expenses');
                const savedRate = localStorage.getItem('busan_2026_rate');
                
                itinerary.value = savedItinerary ? JSON.parse(savedItinerary) : defaultItinerary;
                if (savedExpenses) expenses.value = JSON.parse(savedExpenses);
                if (savedRate) exchangeRate.value = parseFloat(savedRate);

                fetchWeather();
            });

            // Save Data Automatically
            watch([itinerary, expenses, exchangeRate], () => {
                localStorage.setItem('busan_2026_itinerary', JSON.stringify(itinerary.value));
                localStorage.setItem('busan_2026_expenses', JSON.stringify(expenses.value));
                localStorage.setItem('busan_2026_rate', exchangeRate.value);
            }, { deep: true });

            // --- Computed ---
            const filteredItinerary = computed(() => {
                return itinerary.value
                    .filter(item => item.day === activeDay.value)
                    .sort((a, b) => a.time.localeCompare(b.time));
            });

            const totalExpenseKRW = computed(() => expenses.value.reduce((sum, item) => sum + item.amount, 0));
            const totalExpenseTWD = computed(() => Math.round(totalExpenseKRW.value / exchangeRate.value));

            // --- Methods ---

            // Modal Logic (Add & Edit)
            const openModal = (item) => {
                if (item) {
                    // Edit Mode
                    isEditMode.value = true;
                    modalForm.value = { ...item }; // Copy data
                } else {
                    // Add Mode
                    isEditMode.value = false;
                    modalForm.value = { id: Date.now(), time: '12:00', title: '', location: '', desc: '' };
                }
                showModal.value = true;
            };

            const saveItem = () => {
                if (!modalForm.value.title) return;

                if (isEditMode.value) {
                    // Update existing
                    const index = itinerary.value.findIndex(i => i.id === modalForm.value.id);
                    if (index !== -1) {
                        itinerary.value[index] = { ...modalForm.value };
                    }
                } else {
                    // Create new
                    itinerary.value.push({
                        ...modalForm.value,
                        day: activeDay.value,
                        location: modalForm.value.location || modalForm.value.title
                    });
                }
                showModal.value = false;
            };

            const deleteItem = (id) => {
                if(confirm('Á¢∫ÂÆöÂà™Èô§Ê≠§Ë°åÁ®ãÂóéÔºü')) {
                    itinerary.value = itinerary.value.filter(item => item.id !== id);
                }
            };

            // Expense Logic
            const addExpense = () => {
                if (!newExpense.value.item || !newExpense.value.amount) return;
                expenses.value.unshift({
                    date: newExpense.value.date || new Date().toISOString().split('T')[0],
                    item: newExpense.value.item,
                    amount: newExpense.value.amount
                });
                // Reset inputs except date
                newExpense.value.item = '';
                newExpense.value.amount = '';
            };

            const removeExpense = (index) => {
                if(confirm('Âà™Èô§ÈÄôÁ≠ÜÂ∏≥ÁõÆÔºü')) expenses.value.splice(index, 1);
            };

            const resetData = () => {
                if(confirm('Á¢∫ÂÆöÈáçÁΩÆÊâÄÊúâË≥áÊñôÂõûÂà∞È†êË®≠ÂÄºÂóéÔºü')) {
                    itinerary.value = [...defaultItinerary];
                    expenses.value = [];
                    localStorage.removeItem('busan_2026_itinerary');
                    localStorage.removeItem('busan_2026_expenses');
                }
            };

            // Helpers
            const getNaverMapLink = (query) => `https://map.naver.com/p/search/${encodeURIComponent(query)}`;
            const searchNaver = () => mapQuery.value && window.open(getNaverMapLink(mapQuery.value), '_blank');
            const formatNumber = (num) => num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

            // Weather (Simple Fetch)
            const fetchWeather = async () => {
                try {
                    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=35.1796&longitude=129.0756&current=temperature_2m,weather_code,precipitation_probability&timezone=Asia%2FTokyo`);
                    const data = await res.json();
                    currentWeather.value = {
                        temp: Math.round(data.current.temperature_2m),
                        desc: data.current.weather_code <= 3 ? 'Â§öÈõ≤/Êô¥' : 'Èô∞/Èõ®',
                        rain: data.current.precipitation_probability || 0,
                        code: data.current.weather_code
                    };
                    weatherLoading.value = false;
                } catch (e) { weatherLoading.value = false; }
            };

            const getWeatherIcon = (code) => {
                if (code === 0) return '‚òÄÔ∏è';
                if (code <= 3) return '‚òÅÔ∏è';
                if (code <= 67) return 'üåßÔ∏è';
                return 'üå•Ô∏è';
            };

            return {
                currentTab, activeDay, showModal, isEditMode, modalForm,
                itinerary, expenses, exchangeRate, filteredItinerary,
                totalExpenseKRW, totalExpenseTWD, newExpense, mapQuery,
                openModal, saveItem, deleteItem, addExpense, removeExpense,
                weatherLoading, currentWeather, getWeatherIcon,
                formatNumber, searchNaver, getNaverMapLink, resetData
            };
        }
    }).mount('#app');
</script>
</body>
</html>
